<%= content_tag :div, class: "box col-xs-12 col-sm-4", id: dom_id(link) do %>
  <div class="panel panel-default card">
    <div class="panel-heading">
      <%= image_tag link.favicon_url, width: '16px', class: "img-responsive favicon left gt-right" %>
      <h3 class="panel-title gt-reset text-inline pull-left">
        <%= link_to link.provider_name, link_path(link) %>
      </h3>

      <% if link.liked_by?(current_user) %>
        <div class="vote voted">
          <span class="badge"><%= icon 'caret-up' %>
            <span class="like-count text-inline">
              <%= link.likes_count %>
            </span>
          </span>
        </div>
      <% else %>
        <div class="vote">
          <span class="badge">
            <%= link_to like_link_path(link), remote: true, method: 'POST' do %>
              <%= icon 'caret-up' %>
              <span class="like-count text-inline">
                <%= link.likes_count %>
              </span>
            <% end %>
          </span>
        </div>
      <% end %>
      <div class="clearfix"></div>
    </div>

    <div class="row">
      <div class="col-xs-5 col-sm-12">
        <% if link.html.present? == true %>
          <div class="embed-responsive embed-responsive-4by3">
            <%= raw link.html %>
          </div>
        <% else %>
          <%= link_to url_with_protocol(link.url), :target => '_blank', :rel => 'nofollow' do %>
            <%= image_tag link.thumbnail_url, class: "img-responsive center-block lead-img" %>
          <% end%>
        <% end %>
      </div>
      <div class="col-xs-7 col-sm-12">
        <div class="panel-body">
          <%= link_to url_with_protocol(link.url), :target => '_blank', :rel => 'nofollow' do %>
            <h2 class="title gt-reset"><%= link.title %></h2>
            <p class="hidden-xs description gt-top">
              <%= link.description.to_s.truncate(140) %>
            </p>
          <% end %>

          <%= render link.tags %>
        </div>
      </div>
    </div>

    <div class="panel-footer opacity-hover">
      <h3 class="panel-title">
        <%= link_to link_path(link) do %>
          <div class="pull-left">Comments</div>
          <div class="pull-right"><%= link.comments_count %></div>
          <div class="clearfix"></div>
        <% end %>
      </h3>
    </div>

  </div>
<% end %>
